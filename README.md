# MinecraftOTEL (Paper)

OpenTelemetry metrics for Paper servers. This plugin only records server-side
metrics and relies on the OpenTelemetry Java Agent for exporting.

## Features
- Players online (gauge)
- Entities loaded per world (gauge) + add/remove counters
- Chunks loaded per world (gauge) + load/unload counters
- Tick duration histogram (ms)
- TPS and MSPT (avg + p95)
- Optional Spark-backed sampling (preferSpark)

## Requirements
- Java 21
- Paper server (Paper API)
- OpenTelemetry Java Agent attached to the JVM

## Metrics
- `minecraft.players.online` (gauge)
- `minecraft.entities.loaded` (gauge, attribute: `world`)
- `minecraft.chunks.loaded` (gauge, attribute: `world`)
- `minecraft.entities.added_total` (counter, attribute: `world`)
- `minecraft.entities.removed_total` (counter, attribute: `world`)
- `minecraft.chunks.load_total` (counter, attribute: `world`)
- `minecraft.chunks.unload_total` (counter, attribute: `world`)
- `minecraft.tick.duration` (histogram, ms)
- `minecraft.server.tps` (gauge, attribute: `window` = `1m|5m|15m`)
- `minecraft.server.mspt.avg` (gauge, ms)
- `minecraft.server.mspt.p95` (gauge, ms)

No high-cardinality labels are used (no player UUID/name, no chunk coordinates).

## Configuration
`config.yml` (Bukkit default config):

```yaml
otel:
  enable:
    tick: true
    entities: true
    chunks: true
    tpsMspt: true
  preferSpark: true
sampling:
  intervalSeconds: 1
  baselineScanIntervalSeconds: 10
```

## Using the OpenTelemetry Java Agent
This plugin does not initialize any OpenTelemetry SDK or exporter. Attach the
Java Agent to your server startup and configure it normally.

Example (adjust exporter settings):
```
-javaagent:/path/to/opentelemetry-javaagent.jar
```

## Build
```
./gradlew build
```

## Notes
- `plugin.yml` is generated by the build; do not edit it manually.
- Spark sampling is used only when Spark is installed and `preferSpark` is true.
